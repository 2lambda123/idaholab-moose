[Tests]
  # Error checking
  [./err:not_a_pipe]
    type = 'RunException'
    input = 'err.1phase.i'
    cli_args = "Components/hx/flow_channel=inlet Components/hx/Hw=300"
    expect_err = "hx: The component 'inlet' is not of type 'FlowChannelBase'"
  [../]
  [./err:not_a_hs]
    type = 'RunException'
    input = 'err.1phase.i'
    cli_args = "Components/hx/hs=inlet Components/hx/Hw=300 "
    expect_err = "hx: The component 'inlet' is not of type 'HeatStructureBase'"
  [../]

  [./err:elems_mismatch]
    type = 'RunException'
    input = 'err.1phase.i'
    cli_args = "Components/pipe/n_elems=1 Components/hx/Hw=300"
    expect_err = "hx: The number of elements in component 'pipe' is 1, but the number of axial elements in component 'hs' is 2. They must be the same."
  [../]

  [./err:length_mismatch]
    type = 'RunException'
    input = 'err.1phase.i'
    cli_args = "Components/pipe/length=3 Components/hx/Hw=300"
    expect_err = "hx: The length of component 'pipe' is 3, but the length of component 'hs' is 4. They must be the same."
  [../]

  [./err:wrong_position]
    type = 'RunException'
    input = 'err.1phase.i'
    cli_args = "Components/pipe/position='0 0 0' Components/hx/Hw=300"
    expect_err = "hx: The centers of the elements of flow channel 'pipe' do not equal the centers of the specified heat structure side."
  [../]

  [./err:wrong_orientation]
    type = 'RunException'
    input = 'err.1phase.i'
    cli_args = "Components/pipe/orientation='0 1 0' Components/hx/Hw=300"
    expect_err = "hx: The centers of the elements of flow channel 'pipe' do not equal the centers of the specified heat structure side."
  [../]

  [./err:zero_p_hs_radius]
    type = 'RunException'
    input = 'err.1phase.i'
    cli_args = "Components/pipe/position='0 0.1 0' Components/hx/hs_side=inner Components/hx/Hw=300"
    expect_err = "hx: 'hs_side' parameter is set to 'INNER', but this side of the heat structure 'hs' has radius of zero."
  [../]

  [./err:missing_hw]
    type = 'RunException'
    input = 'err.1phase.i'
    expect_err = "hx: The parameter 'Hw' must be provided when using simple closures."
  [../]

  # Jacobians
  [./jac:cylindrical_top_side_1phase]
    type = 'PetscJacobianTester'
    input = 'jac.1phase.i'
    ratio_tol = 1e-5
    difference_tol = 50
    cli_args = "Debug/check_jacobian=true Components/hs/type=HeatStructureCylindrical Components/hx/hs_side=outer"
  [../]

  [./jac:cylindrical_bottom_side_1phase]
    type = 'PetscJacobianTester'
    input = 'jac.1phase.i'
    ratio_tol = 1e-5
    difference_tol = 50
    cli_args = "Debug/check_jacobian=true Components/pipe/position='0 0 0' Components/hs/inner_radius=0.1 Components/hs/type=HeatStructureCylindrical Components/hx/hs_side=inner"
  [../]

  [./jac:plate_top_side_1phase]
    type = 'PetscJacobianTester'
    input = 'jac.1phase.i'
    ratio_tol = 1e-5
    difference_tol = 50
    cli_args = "Debug/check_jacobian=true Components/hs/type=HeatStructurePlate Components/hs/depth=1 Components/hx/hs_side=outer"
  [../]

  [./jac:plate_bottom_side_1phase]
    type = 'PetscJacobianTester'
    input = 'jac.1phase.i'
    ratio_tol = 1e-5
    difference_tol = 50
    cli_args = "Debug/check_jacobian=true Components/pipe/position='0 0 0' Components/hs/depth=1 Components/hs/type=HeatStructurePlate Components/hx/hs_side=inner"
  [../]
[]
