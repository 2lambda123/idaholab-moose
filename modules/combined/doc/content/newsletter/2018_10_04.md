# MOOSE Newsletter (October 2018)

## MOOSEDocs

We are continuing to improve documentation for MOOSE, you likely noticed that our website changed
recently. If you submitted a change to MOOSE you may of also noticed that we are mandating that
all test specifications files (i.e., "tests" files) that are new or modified include additional
language that details tests purpose, what system(s) it is testing, and what issues
are associated with the test.  This additional documentation serves two purposes, first it is
useful when trying to understand a test and second it is being used for software life cycle
documentation.

There is also ongoing work being done for converting "MOOSEDown" into LaTeX and there will be
more announcements on this task in the coming weeks and months.

## ParsedFunction Improvement

The `ParsedFunction` can now take another function as a parameter - similarly like it can take
a scalar value or a postprocessor value. An example syntax follows:

```
[./a_fn]
  type = ParsedFunction
  value = sin(x)
[../]
[./parsed_fn]
  type = ParsedFunction
  value = '4*sqrt(a)'
  vars = 'a'
  vals = 'a_fn'
[../]
```

Obtaining the values from a nested function honors the time and space position of the evaluating
function, i.e. in our example `a_fn` will be evaluated at the same time and space position as
`parsed_fn` function.

## App Object/Action Registration Changes ##

Previously a MOOSE-based application's main App class would contain several registration methods -
e.g. registerObjects, associateSyntax, registerExecFlags, etc. along with a special `extern "C"`
function paired with each one.  We are moving away from these functions in favor of a more
consolidated, simple approach.  Applications should now perform *all* registration (objects,
syntax, actions, exec flags) and special setup inside a static registerAll member function:

```
static void registerAll(Factory & f, ActionFactory & af, Syntax & s);
```

Applications will no longer be expected to register MOOSE framework objects directly - nor perform
any registration for transitive dependencies.  If your FooApp application depends on the
heat_conduction module and BarApp, then your registerAll function should look something like this:

```
FooApp::registerAll(Factory & f, ActionFactory & af, Syntax & s)
{
  Registry::registerObjectsTo(f, {"FooApp"});
  Registry::registerActionsTo(af, {"FooApp"});

  ModulesApp::registerAll(f, af, s);
  BarApp::registerAll(f, af, s);
}

extern "C" void
FooApp__registerAll(Factory & f, ActionFactory & af, Syntax & s)
{
  FooApp::registerAll(f, af, s);
}
```

All registration-related code in your App's constructor should be removed in favor of a single
call: `registerAll(_factory, _action_factory, _syntax);`.  Each application is only responsible to
call registerAll for its *direct* dependencies.  If BarApp depends on the fluid_properties module
or BazApp - then those registrations should occur automatically from calls within
BarApp::registerAll (no need for you to do that in FooApp).

Please add the registerAll function to all of your applications/modules.  If your
application/module is not depended on by any other applications, than you can just remove/delete
the old functions (including the `FooApp__register[Bla]` functions) in favor of the new registerAll.
If your application/module does have downstream dependencies, then you will need to keep the old
functions (please add deprecation warnings via the mooseDeprecated macro) until downstream
dependencies have neen updated.  Deprecation messages/warnings have been added to the old
registerObjects, etc. functions in MOOSE and its modules. 

If your application has a test app (e.g. FooTestApp) then this is the new convention:


```
...

FooTestApp::FooTestApp(const InputParameters & parameters) : MooseApp(parameters)
{
  FooTestApp::registerAll(
      _factory, _action_factory, _syntax, getParam<bool>("allow_test_objects"));
}

void
FooTestApp::registerAll(Factory & f, ActionFactory & af, Syntax & s, bool use_test_objs)
{
  FooApp::registerAll(f, af, s);
  if (use_test_objs)
  {
    Registry::registerObjectsTo(f, {"FooTestApp"});
    Registry::registerActionsTo(af, {"FooTestApp"});

    // ... register test action syntax, etc.
  }
}

...
```
