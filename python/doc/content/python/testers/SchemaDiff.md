# SchemaDiff

`SchemaDiff` tests compare `JSON`, `XML`, and `CSV` output(s) for the test to a reference in the specified
`gold_dir` folder. These outputs are generated by certain user objects, by the mesh, and by reporters (for example,
the `PerfGraphReporter` or the `MeshInfo` reporter).

SchemaDiff is intended to serve as a template class for comparing any markup/schema file, and therefore should not be used directly in a test file, but through the specific `Diff` testers for each data type, i.e. `CSVDiff`, `XMLDiff`, and `JSONDiff`.

## Options

Test configuration options are added to the `tests` file.

These options are universal to all differs that rely on SchemaDiff. 

- `schemadiff`: A list of files to compare. Can be any of the aforementioned file types

- `gold_dir`: The directory where the "gold standard" files reside relative to the `TEST_DIR`: (default: ./gold/)

- `gold_file`: Specify the file in the gold_dir that the output should be compared against. This only needs to be set if the gold file uses a different file name than the output file

- `ignored_items`: A list of keys, values, or attributes to skip when performing a comparison. Only relevant for `XML` and `JSON` files

- `abs_zero`:  Sets an absolute threshold for values deemed too insignificantly small to compare, where numeric values that are less than `abs_zero` will be considered as having zero differences. For example, with an `abs_zero` of `0.1`, if two values being compared are `0.01` and `0.015`, the values will not trigger a detection of a difference. Defaults to `1e-10`

- `rel_err`: Sets a threshold for the maximum allowed relative error between two values. When comparing two values, only differences that have relative errors above the supplied `rel_err` threshold will be considered. Defaults to `5.5e-6`. Relative error is calculated as the following:
  \begin{equation*}
  \text{Relative error} = \frac{|\text{exact value} - \text{approximation}|}{|\text{exact value}|} \times 100\%
  \end{equation*}

Other test commands & restrictions may be found in the [TestHarness documentation](TestHarness.md).

## Example test configuration in the MOOSE test suite

In this example, the mesh output by a [RenameBlockGenerator.md] is being checked using a
`MeshInfo` reporter, which outputs a `JSON` file. This `JSON` file is compared to a reference to
make sure the mesh block names are properly changed.

!listing test/tests/meshgenerators/rename_block_generator/tests

