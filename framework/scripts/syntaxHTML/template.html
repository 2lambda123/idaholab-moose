<%def name="genBlock(block)">
  <%doc>Only display Child from a node named /ParentBlock/Child </%doc>
  <li id="base"><b>${block['name'].split('/')[-1] |u}</b>
    <ul>
      % if block['type'] != None:
        <li>type = ${block['type']}</li>
      % endif

      <%doc>Generate parameters, required ones are red</%doc>
      % if block['parameters'] != None:
        % for param in block['parameters']:
          <li id="param"><div class="
            % if param['required'] == True:
              required
            % endif
            ">${param['name']}</div>
              <ul>
                % if param['default'] != None:
                  <li>Default: ${param['default']}</li>
                % endif
                <li>Description: ${param['description']}</li>
              </ul>
          </li>
        % endfor
      % endif

      <%doc>Recursively generate sub blocks</%doc>
      % if block['subblocks'] != None:
        % for block in block['subblocks']:
          ${genBlock( block )}
        % endfor
      % endif
    </ul>
  </li>
</%def>

<html>
<head>
  <title>${project} Input File Syntax</title>

  <link rel="stylesheet" type="text/css" href="static/styles.css"/>

  <!-- based off of http://www.jstree.com/documentation/core -->
  <script type="text/javascript" src="static/jquery.js"></script> 
  <script type="text/javascript" src="static/jquery.cookie.js"></script> 
  <script type="text/javascript" src="static/jquery.jstree.min.js"></script> 
</head>
<body>
  <h1>${project} Input File Syntax</h1>

  <b>Blocks</b> are bolded.<br/>
  <span class="red">Red parameters</span> are required.

  <!-- search (hopefully) coming soon!
  <br/> <br/>
  <input type="text" id="searchBox" value="search"/><input type="button" value="Search" id="search"/> <br/>
  -->

  <ul id="tree">
    % for block in data:
      ${genBlock( block )}
    % endfor
  </ul>

  <script type="text/javascript" class="source"> 
  $(function () {
    //bind search function to search button
    $("#search").click( function() {
      $("#tree").jstree("search", document.getElementById("searchBox").value);
    });

    //initialize jstree
    $("#tree")
      .jstree({ plugins : [ "themes", "html_data", "search" ], core : { html_titles : true }, search : { case_insensitive : true } })
      .bind( "search.jstree", function( e, data ) {
        alert( "Found " + data.rslt.nodes.length + " nodes matching '" + data.rslt.str + "'.");
      });
    });
  </script> 

  <div id="footer">
    <hr/>
    Generated ${time}
  </div>

</body>
</html>
